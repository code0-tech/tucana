syntax = "proto3";

package sagittarius;

option ruby_package = "Tucana::Sagittarius";

message AdapaterStatusInformation {
  oneof data {
    string endpoint = 1; // e.g. URL, cron expression, ...
  }
}

enum Status {
  UNKNOWN = 0;
  NOT_RESPONDING = 1;
  NOT_READY = 2;
  RUNNING = 3;
  STOPPED = 4;
}

message AdapterRuntimeStatus {
  Status status = 1;
  string timestamp = 2; // epoch timestamp in milliseconds

  string identifier = 3; // unique identifier of the adapter

  // All the supported features: e.g. ['http'] / ['cron'] / ['http', 'cron']
  repeated string feature_set = 4;
  repeated AdapaterStatusInformation informations = 5;
}

message ExecutionRuntimeStatus {
  Status status = 1;
  string timestamp = 2; // epoch timestamp in milliseconds

  string identifier = 3; // unique identifier of the adapter

  // All the supported features: e.g. ['http'] / ['cron'] / ['http', 'cron']
  repeated string feature_set = 4;
}

message RuntimeStatusUpdateRequest {
  oneof status {
    AdapterRuntimeStatus adapter_runtime_status = 1;
    ExecutionRuntimeStatus execution_runtime_status = 2;
  }
}

message RuntimeStatusUpdateResponse {
  bool success = 1;
}

service RuntimeStatusService {
  rpc Update(RuntimeStatusUpdateRequest) returns (RuntimeStatusUpdateResponse) {}
}
